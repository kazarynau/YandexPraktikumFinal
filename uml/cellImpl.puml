
@startuml

abstract class GraphInterface {
    +{abstract} GetReferencedCells(): vector<Position>
    +{abstract} GetDependentCells(): vector<Position>
    +{abstract} AddDependentCell(in pos: Position)
    +{abstract} DeleteDependentCell(in pos: Position)
}

abstract class Impl {
    +{abstract} GetValue(in getCellValueCallback: function): Value
    +{abstract} GetText(): string
    +{abstract} InvalidateCache()
}

class Impl extends GraphInterface

class EmptyImpl {
}

class TextImpl {
    +TextImpl(in text: string)
    +Set(in text: string)
    -value_: string
}

class FormulaImpl {
    +FormulaImpl(in text: string)
    +Set(in text: string)
    -formula_: FormulaInterface*
    -dependentCells_: set<Position>
    -cache_: optional<CellInterface::Value>
}

class EmptyImpl implements Impl
class TextImpl implements Impl
class FormulaImpl implements Impl

@enduml
